
<!DOCTYPE HTML>
<html lang="" >
    <head>
        <meta charset="UTF-8">
        <title>Elastic Search Â· SciCat Documentation</title>
        <meta http-equiv="X-UA-Compatible" content="IE=edge" />
        <meta name="description" content="">
        <meta name="generator" content="HonKit 5.1.4">
        
        
        
    
    
    <link rel="stylesheet" href="../../../gitbook/style.css">

    
            
                
                <link rel="stylesheet" href="../../../gitbook/gitbook-plugin-chapter-fold/chapter-fold.css">
                
            
                
                <link rel="stylesheet" href="../../../gitbook/gitbook-plugin-mermaid-gb3/mermaid/mermaid.css">
                
            
                
                <link rel="stylesheet" href="../../../gitbook/@honkit/honkit-plugin-highlight/website.css">
                
            
                
                <link rel="stylesheet" href="../../../gitbook/gitbook-plugin-search/search.css">
                
            
                
                <link rel="stylesheet" href="../../../gitbook/gitbook-plugin-fontsettings/website.css">
                
            
        

    

    
        
        <link rel="stylesheet" href="../../../styles/website.css">
        
    


    

        
    
    
    <meta name="HandheldFriendly" content="true"/>
    <meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black">
    <link rel="apple-touch-icon-precomposed" sizes="152x152" href="../../../gitbook/images/apple-touch-icon-precomposed-152.png">
    <link rel="shortcut icon" href="../../../gitbook/images/favicon.ico" type="image/x-icon">

    
    <link rel="next" href="../frontend/configuration.html" />
    
    
    <link rel="prev" href="../backend/authorization/authorization_samples.html" />
    

    </head>
    <body>
        
<div class="book honkit-cloak">
    <div class="book-summary">
        
            
<div id="book-search-input" role="search">
    <input type="text" placeholder="Type to search" />
</div>

            
                <nav role="navigation">
                


<ul class="summary">
    
    

    

    
        
        
    
        <li class="chapter " data-level="1.1" data-path="../../../">
            
                <a href="../../../">
            
                    
                    SciCat Overview
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.2" data-path="../../../Users/">
            
                <a href="../../../Users/">
            
                    
                    User Guide
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.2.1" data-path="../../../Users/Anonymous.html">
            
                <a href="../../../Users/Anonymous.html">
            
                    
                    Anonymous View
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.2.2" data-path="../../../Users/Login.html">
            
                <a href="../../../Users/Login.html">
            
                    
                    Login
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.2.3" data-path="../../../Users/Dashboard.html">
            
                <a href="../../../Users/Dashboard.html">
            
                    
                    Dashboard
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.2.4" data-path="../../../Users/Dataset_Details.html">
            
                <a href="../../../Users/Dataset_Details.html">
            
                    
                    Dataset Details
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.2.4.1" data-path="../../../Users/Dataset_Details_Files.html">
            
                <a href="../../../Users/Dataset_Details_Files.html">
            
                    
                    Dataset Filelisting
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.2.4.2" data-path="../../../Users/Dataset_Attachments.html">
            
                <a href="../../../Users/Dataset_Attachments.html">
            
                    
                    Dataset Attachments
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.2.4.3" data-path="../../../Users/View_Raw_Metadata.html">
            
                <a href="../../../Users/View_Raw_Metadata.html">
            
                    
                    View Raw JSON data
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.2.4.4" data-path="../../../Users/Edit_Scientific_Metadata.html">
            
                <a href="../../../Users/Edit_Scientific_Metadata.html">
            
                    
                    Edit Scientific Metadata
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.2.5" data-path="../../../Users/Publishing.html">
            
                <a href="../../../Users/Publishing.html">
            
                    
                    Dataset Publishing
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.2.6" data-path="../../../Users/Jobs.html">
            
                <a href="../../../Users/Jobs.html">
            
                    
                    Archival and Retrieval Jobs
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.2.7" data-path="../../../Users/SampleData.html">
            
                <a href="../../../Users/SampleData.html">
            
                    
                    Sample Data Entry
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.3" data-path="../../../Operator/">
            
                <a href="../../../Operator/">
            
                    
                    Operator Guide
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.3.1" data-path="../../../Operator/Step_by_Step_Setup.html">
            
                <a href="../../../Operator/Step_by_Step_Setup.html">
            
                    
                    Step by Step instruction
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.3.2" data-path="../../../Operator/Step_by_Step_Setup_Docker.html">
            
                <a href="../../../Operator/Step_by_Step_Setup_Docker.html">
            
                    
                    Deploy with Docker Compose
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.3.3" data-path="../../../Operator/Step_by_Step_Setup_Kubernetes.html">
            
                <a href="../../../Operator/Step_by_Step_Setup_Kubernetes.html">
            
                    
                    Deploy with Kubernetes
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.3.4" data-path="../../../Operator/Step_by_Step_Setup_Zip_Service.html">
            
                <a href="../../../Operator/Step_by_Step_Setup_Zip_Service.html">
            
                    
                    Deploy Zip Service
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.4" data-path="../../../Ingestor/">
            
                <a href="../../../Ingestor/">
            
                    
                    Ingestor Guide
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.4.1" data-path="../../../Ingestor/ingestManual.html">
            
                <a href="../../../Ingestor/ingestManual.html">
            
                    
                    Ingest Manual PSI
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.4.2" data-path="../../../Ingestor/IngestManual_ESS.html">
            
                <a href="../../../Ingestor/IngestManual_ESS.html">
            
                    
                    Ingest Instructions ESS
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.4.3" data-path="../../../Ingestor/GettingMetadataIntoScicat.html">
            
                <a href="../../../Ingestor/GettingMetadataIntoScicat.html">
            
                    
                    Manual Ingest the Hard Way
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.5" data-path="../../">
            
                <a href="../../">
            
                    
                    Developers Guide
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.5.1" data-path="../../v3.x/">
            
                <a href="../../v3.x/">
            
                    
                    v3.x
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.5.1.1" data-path="../../v3.x/StartHere.html">
            
                <a href="../../v3.x/StartHere.html">
            
                    
                    Overview of Backend and Model
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.5.1.2" data-path="../../v3.x/Data_Model.html">
            
                <a href="../../v3.x/Data_Model.html">
            
                    
                    An Introduction to the Data Model
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.5.1.3" data-path="../../v3.x/Running.html">
            
                <a href="../../v3.x/Running.html">
            
                    
                    Running the Components
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.5.1.4" data-path="../../v3.x/Configuration.html">
            
                <a href="../../v3.x/Configuration.html">
            
                    
                    Configuration
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.5.1.5" data-path="../../v3.x/Theming.html">
            
                <a href="../../v3.x/Theming.html">
            
                    
                    Theming
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.5.1.6" data-path="../../v3.x/Login.html">
            
                <a href="../../v3.x/Login.html">
            
                    
                    Login and Accounts
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.5.1.7" data-path="../../v3.x/OIDC.html">
            
                <a href="../../v3.x/OIDC.html">
            
                    
                    OIDC Integration
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.5.1.8" data-path="../../v3.x/Ngrx.html">
            
                <a href="../../v3.x/Ngrx.html">
            
                    
                    State Management in Angular
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.5.1.9" data-path="../../v3.x/Testing_backend.html">
            
                <a href="../../v3.x/Testing_backend.html">
            
                    
                    Testing Backend
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.5.1.10" data-path="../../v3.x/Testing.html">
            
                <a href="../../v3.x/Testing.html">
            
                    
                    Testing Frontend
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.5.1.11" data-path="../../v3.x/Contributing.html">
            
                <a href="../../v3.x/Contributing.html">
            
                    
                    Contributing
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.5.1.12" data-path="../../v3.x/Development_Methods.html">
            
                <a href="../../v3.x/Development_Methods.html">
            
                    
                    Git Flow Workflow
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.5.2" data-path="../">
            
                <a href="../">
            
                    
                    v4.x
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.5.2.1" data-path="../overview.html">
            
                <a href="../overview.html">
            
                    
                    Overview
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.5.2.2" data-path="../contributing.html">
            
                <a href="../contributing.html">
            
                    
                    Contributing
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.5.2.3" data-path="../developers_guide.html">
            
                <a href="../developers_guide.html">
            
                    
                    Developer Guide
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.5.2.4" data-path="../Data_Model.html">
            
                <a href="../Data_Model.html">
            
                    
                    An Introduction to the Data Model
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.5.2.5" data-path="../running.html">
            
                <a href="../running.html">
            
                    
                    Running the Components
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.5.2.6" data-path="../configuration.html">
            
                <a href="../configuration.html">
            
                    
                    Configuration
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.5.2.6.1" data-path="../backend/configuration.html">
            
                <a href="../backend/configuration.html">
            
                    
                    Backend
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.5.2.6.1.1" data-path="../backend/configuration/jobconfig.html">
            
                <a href="../backend/configuration/jobconfig.html">
            
                    
                    Jobs
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.5.2.6.2" data-path="../backend/authorization.html">
            
                <a href="../backend/authorization.html">
            
                    
                    Authorization
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.5.2.6.2.1" data-path="../backend/authorization/authorization_datasets.html">
            
                <a href="../backend/authorization/authorization_datasets.html">
            
                    
                    Datasets
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.5.2.6.2.2" data-path="../backend/authorization/authorization_origdatablocks.html">
            
                <a href="../backend/authorization/authorization_origdatablocks.html">
            
                    
                    OrigDatablocks
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.5.2.6.2.3" data-path="../backend/authorization/authorization_proposals.html">
            
                <a href="../backend/authorization/authorization_proposals.html">
            
                    
                    Proposals
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.5.2.6.2.4" data-path="../backend/authorization/authorization_jobs.html">
            
                <a href="../backend/authorization/authorization_jobs.html">
            
                    
                    Jobs
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.5.2.6.2.5" data-path="../backend/authorization/authorization_instruments.html">
            
                <a href="../backend/authorization/authorization_instruments.html">
            
                    
                    Instruments
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.5.2.6.2.6" data-path="../backend/authorization/authorization_users.html">
            
                <a href="../backend/authorization/authorization_users.html">
            
                    
                    Users
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.5.2.6.2.7" data-path="../backend/authorization/authorization_samples.html">
            
                <a href="../backend/authorization/authorization_samples.html">
            
                    
                    Samples
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter active" data-level="1.5.2.6.3" data-path="elasticsearch.html">
            
                <a href="elasticsearch.html">
            
                    
                    Elastic Search
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.5.2.6.4" data-path="../frontend/configuration.html">
            
                <a href="../frontend/configuration.html">
            
                    
                    Frontend
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.5.2.7" data-path="../Theming.md">
            
                <span>
            
                    
                    Theming
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.5.2.8" data-path="../Login.html">
            
                <a href="../Login.html">
            
                    
                    Login and Accounts
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.5.2.9" data-path="../OIDC.md">
            
                <span>
            
                    
                    OIDC Integration
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.5.2.10" data-path="../testing.md">
            
                <span>
            
                    
                    Testing
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.5.2.10.1" data-path="../backend/testing_backend.html">
            
                <a href="../backend/testing_backend.html">
            
                    
                    Backend
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.5.2.10.1.1" data-path="../backend/testing/instrument.html">
            
                <a href="../backend/testing/instrument.html">
            
                    
                    Instrument
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.5.2.10.1.2" data-path="../backend/testing/user_authorization.html">
            
                <a href="../backend/testing/user_authorization.html">
            
                    
                    User Authorization
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.5.2.10.2" data-path="../frontend/testing.md">
            
                <span>
            
                    
                    Frontend
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.5.2.11" data-path="../Migration.html">
            
                <a href="../Migration.html">
            
                    
                    Migration v3.x to v4.x
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.5.3" data-path="../../Documentation.html">
            
                <a href="../../Documentation.html">
            
                    
                    Documentation
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    

    

    <li class="divider"></li>

    <li>
        <a href="https://github.com/honkit/honkit" target="blank" class="gitbook-link">
            Published with HonKit
        </a>
    </li>
</ul>


                </nav>
            
        
    </div>

    <div class="book-body">
        
            <div class="body-inner">
                
                    

<div class="book-header" role="navigation">
    

    <!-- Title -->
    <h1>
        <i class="fa fa-circle-o-notch fa-spin"></i>
        <a href="../../.." >Elastic Search</a>
    </h1>
</div>




                    <div class="page-wrapper" tabindex="-1" role="main">
                        <div class="page-inner">
                            
<div id="book-search-results">
    <div class="search-noresults">
    
                                <section class="normal markdown-section">
                                
                                <h1 id="getting-started">Getting started</h1>
<p>To be able to start application with Elasticsearch you will need to:</p>
<ol>
<li>Start with <code>npm prepare:local</code> to executes docker-compose file which pull and run Elasticsearch cluster as a docker container.</li>
<li>Start the application with <code>npm run start</code></li>
</ol>
<h1 id="check-the-env-file">Check the .env file</h1>
<p>Following environment variables are required to run Elasticsearch with Scicat Backend:</p>
<table>
<thead>
<tr>
<th><code>Variables</code></th>
<th style="text-align:left">Values</th>
<th style="text-align:left">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>ELASTICSEARCH_ENABLED</code></td>
<td style="text-align:left"><code>yes</code> or <code>no</code></td>
<td style="text-align:left">Flag to enable/disable the ElasticSearch service</td>
</tr>
<tr>
<td><code>ES_HOST</code></td>
<td style="text-align:left"><a href="https://localhost:9200" target="_blank">https://localhost:9200</a></td>
<td style="text-align:left">Use <code>http</code> if <code>xpack.security.enabled</code> set to <code>false</code></td>
</tr>
<tr>
<td><code>ES_USERNAME</code> (optional)</td>
<td style="text-align:left">elastic</td>
<td style="text-align:left">Elasticsearch cluster username. Can be customized with docker image environment values with <code>ELASTIC_USERNAME</code></td>
</tr>
<tr>
<td><code>ES_PASSWORD</code></td>
<td style="text-align:left">password</td>
<td style="text-align:left">Elasticsearch cluster password. Can be customized with docker image environment values <code>ELASTIC_PASSWORD</code></td>
</tr>
<tr>
<td><code>MONGODB_COLLECTION</code></td>
<td style="text-align:left">Dataset</td>
<td style="text-align:left">Collection name to be mapped into specified Elasticsearch index</td>
</tr>
<tr>
<td><code>ES_MAX_RESULT</code></td>
<td style="text-align:left">210000</td>
<td style="text-align:left">Maximum records can be indexed into Elasticsearch. If not set, default is <code>10000</code></td>
</tr>
<tr>
<td><code>ES_FIELDS_LIMIT</code></td>
<td style="text-align:left">400000</td>
<td style="text-align:left">The total number of fields in an index. If not set, default is <code>1000</code></td>
</tr>
<tr>
<td><code>ES_INDEX</code></td>
<td style="text-align:left">dataset</td>
<td style="text-align:left">Setting default index for the application</td>
</tr>
<tr>
<td><code>ES_REFRESH</code></td>
<td style="text-align:left">wait_for</td>
<td style="text-align:left">Wait for the change to become visible - CRUD actions</td>
</tr>
<tr>
<td></td>
</tr>
</tbody>
</table>
<h2 id="note-">** NOTE **</h2>
<p><code>ES_REFRESH="wait_for"</code> is used for better testing flow. For production it should be set to false. Detailed docs about this setting can be found: <a href="https://www.elastic.co/guide/en/elasticsearch/reference/current/docs-refresh.html" target="_blank">docs-refresh</a></p>
<h1 id="steps-to-synchronize-data-with-elasitcsearch">Steps to synchronize data with Elasitcsearch</h1>
<p>To enable search queries in Elasticsearch, you should adhere to the following steps:</p>
<ol>
<li>Open Swagger page <code>http://localhost:3000/explorer</code>, Authorize with <code>admin</code> token</li>
<li>Open elastic-search endpoints and execute <code>create-index</code>.
<em><strong>NOTE:</strong></em> This step can be skipped if you want to use default index <code>dataset</code></li>
<li>execute <code>sync-database</code> to sync data into the given index.</li>
</ol>
<p>If you see the following response, it means Elasticsearch is ready for use.</p>
<pre><code>{
  "total": 21670,
  "failed": 0,
  "retry": 0,
  "successful": 21670,
  "noop": 0,
  "time": 4777,
  "bytes": 279159021,
  "aborted": false
}
</code></pre><h1 id="index-analysis-and-mapping-settings">Index, analysis and mapping settings</h1>
<p>Index settings in Elasticsearch are used to define various configurations and behaviors for an index. Index settings are vital for optimizing Elasticsearch's performance, relevance of search results, and resource management, ensuring that the index operates efficiently and effectively according to the specific needs of the application using it.</p>
<p>Pre-defined index settings &amp; dynamic mapping for nested objects can be found <code>/src/elastic-search/configuration/indexSetting.ts</code></p>
<p>Fields to be mapped into Elasticsearch index can be found <code>/src/elastic-search/configuration/datasetFieldMapping.ts</code></p>
<p><strong>Index settings:</strong></p>
<pre><code>export const defaultElasticSettings = {
  index: {
    max_result_window: process.env.ES_MAX_RESULT || 2000000,
    number_of_replicas: 0,
    mapping: {
      total_fields: {
        limit: process.env.ES_FIELDS_LIMIT || 2000000,
      },
      nested_fields: {
        limit: 1000,
      },
    },
  },
  analysis: {
    analyzer: {
      autocomplete: {
        tokenizer: "autocomplete",
        filter: ["lowercase"],
      },
      autocomplete_search: {
        tokenizer: "lowercase",
      },
    },
    tokenizer: {
      autocomplete: autocomplete_tokenizer,
    },
  },
} as IndicesIndexSettingsAnalysis;
</code></pre><table>
<thead>
<tr>
<th><code>Object</code></th>
<th style="text-align:left">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>index</code></td>
<td style="text-align:left">It contains settings that determine how an Elasticsearch index works, like how many results you can get from a search and how many copies of the data it should store. More details in <a href="https://www.elastic.co/guide/en/elasticsearch/reference/current/index-modules.html" target="_blank">index modules</a></td>
</tr>
<tr>
<td><code>index.max_result_window</code></td>
<td style="text-align:left">Determines the maximum number of documents returned in a query. <code>Default is 10000</code></td>
</tr>
<tr>
<td><code>index.number_of_replicas</code></td>
<td style="text-align:left">Sets the number of replica shards. <code>Default is 1</code></td>
</tr>
<tr>
<td><code>index.mapping.total_fields.limit</code></td>
<td style="text-align:left">Sets the maximum number of fields an index can have. <code>Default is 1000</code></td>
</tr>
<tr>
<td><code>index.mapping.nested_fields.limit</code></td>
<td style="text-align:left">Sets the maximum number of nested fields. <code>Default is 50</code></td>
</tr>
<tr>
<td><code>analysis</code></td>
<td style="text-align:left">It defines how text data is processed before it is indexed, including custom analyzers and tokenizers which control the conversion of text into tokens or terms. More details in <a href="https://www.elastic.co/guide/en/elasticsearch/reference/current/analyzer.html" target="_blank">analyzer</a> and <a href="https://www.elastic.co/guide/en/elasticsearch/reference/8.8/analysis.html" target="_blank">analysis</a></td>
</tr>
</tbody>
</table>
<p>&lt;/br&gt;</p>
<p><strong>Dynamic mapping:</strong></p>
<p>Dynamic mapping is currently only used for scientific field. More details in <a href="https://www.elastic.co/guide/en/elasticsearch/reference/8.8/dynamic-templates.html" target="_blank">Dynamic template</a></p>
<pre><code>export const dynamic_template: Record&lt;string, MappingDynamicTemplate&gt;[] = [
  {
    string_as_keyword: {
      path_match: "scientificMetadata.*.*",
      match_mapping_type: "string",
      mapping: {
        type: "keyword",
        ignore_above: 256,
      },
    },
  },
  {
    long_as_double: {
      path_match: "scientificMetadata.*.*",
      match_mapping_type: "long",
      mapping: {
        type: "double",
        coerce: true,
        ignore_malformed: true,
      },
    },
  },
  {
    date_as_keyword: {
      path_match: "scientificMetadata.*.*",
      match_mapping_type: "date",
      mapping: {
        type: "keyword",
        ignore_above: 256,
      },
    },
  },
];
</code></pre><h1 id="apis">APIs</h1>
<p><code>NOTE: All requests require admin permissions.</code></p>
<p>For search query integration it is suggested to use client search service directly, which can be found <code>/src/elastic-search/elastic-search.service.ts</code></p>
<p><strong>Following table is existing controller endpoints:</strong></p>
<table>
<thead>
<tr>
<th>endpoint</th>
<th>parameters</th>
<th>request</th>
<th>description</th>
</tr>
</thead>
<tbody>
<tr>
<td>/api/v3/elastic-search/create-index?index=</td>
<td><code>string</code></td>
<td>query</td>
<td>Create an index with this name</td>
</tr>
<tr>
<td>/api/v3/elastic-search/sync-database?index=</td>
<td><code>string</code></td>
<td>query</td>
<td>Sync datasets into elastic search with this index</td>
</tr>
<tr>
<td>/api/v3/elastic-search/search</td>
<td><code>{ "text": "", "ownerGroup": [], "creationLocation": [], "type": [], "keywords": [], "isPublished": false, "scientific": [{"lhs": "", "relation": "", "rhs": 0, "unit": ""}]}</code></td>
<td>body</td>
<td>Search query</td>
</tr>
<tr>
<td>/api/v3/elastic-search/delete-index</td>
<td><code>string</code></td>
<td>query</td>
<td>Delete an index with this name</td>
</tr>
<tr>
<td>/api/v3/elastic-search/get-index</td>
<td><code>string</code></td>
<td>query</td>
<td>Get an index settings with this name</td>
</tr>
<tr>
<td>/api/v3/elastic-search/update-index</td>
<td><code>to be updated</code></td>
<td>to be updated</td>
<td>to be updated</td>
</tr>
</tbody>
</table>
<h1 id="setting-up-a-local-elasticsearch-cluster">Setting up a local Elasticsearch cluster</h1>
<h2 id="docker-configuration">Docker Configuration</h2>
<p>For local development, you can spin up an Elasticsearch cluster using Docker with the following configuration:</p>
<p><em>Elasticsearch image configuration can be found in <code>./CI/E2E/docker-compose-local.yaml</code></em></p>
<pre><code>es01:
  image: docker.elastic.co/elasticsearch/elasticsearch:8.8.2
  ports:
    - 9200:9200
  environment:
    - xpack.security.enabled=false
    - node.name=es01
    - ES_JAVA_OPTS=-Xms2g -Xmx2g
    - cluster.name=es-cluster
    - cluster.initial_master_nodes=es01
    - ELASTIC_PASSWORD=password
    - bootstrap.memory_lock=true
  mem_limit: 4g
  ulimits:
    memlock:
      soft: -1
      hard: -1
</code></pre><table>
<thead>
<tr>
<th><strong><code>Settings</code></strong></th>
<th><strong><code>Description</code></strong></th>
</tr>
</thead>
<tbody>
<tr>
<td>Image Version</td>
<td>Docker image for Elasticsearch: <code>docker.elastic.co/elasticsearch/elasticsearch:8.8.2</code>.</td>
</tr>
<tr>
<td>Port</td>
<td>Container-to-host port mapping: <code>9200:9200</code>.</td>
</tr>
<tr>
<td>mem_limit</td>
<td>Maximum container memory, influenced by <code>ES_JAVA_OPTS</code>.</td>
</tr>
<tr>
<td>ulimits.memlock (soft, hard)</td>
<td>Memory locking limits: <code>-1</code> for unlimited.</td>
</tr>
<tr>
<td><strong><code>Variables</code></strong></td>
<td><strong><code>Description</code></strong></td>
</tr>
<tr>
<td>xpack.security.enabled</td>
<td>Toggle for Elasticsearch security; <code>false</code> disables authentication for development.</td>
</tr>
<tr>
<td>node.name</td>
<td>Unique Elasticsearch node name; essential for cluster node identification.</td>
</tr>
<tr>
<td>ES_JAVA_OPTS</td>
<td>JVM heap memory settings for Elasticsearch performance (e.g., <code>-Xms2g -Xmx2g</code>).</td>
</tr>
<tr>
<td>cluster.name</td>
<td>Name of the Elasticsearch cluster for node grouping.</td>
</tr>
<tr>
<td>ELASTIC_PASSWORD</td>
<td>Password for the 'elastic' user; not needed if security is disabled.</td>
</tr>
<tr>
<td>bootstrap.memory_lock</td>
<td>Prevents swapping Elasticsearch memory to disk when enabled.</td>
</tr>
</tbody>
</table>
<h2 id="using-helm-for-kubernetes">Using Helm for Kubernetes</h2>
<p>For those looking to deploy on Kubernetes, refer to the official <a href="https://github.com/elastic/helm-charts/tree/main/elasticsearch" target="_blank">Helm chart documentation</a> for Elasticsearch. Helm charts provide a more production-ready setup and can manage complex configurations.</p>
<p><strong>More configuration information:</strong></p>
<ul>
<li><a href="https://www.elastic.co/guide/en/elasticsearch/reference/8.8/docker.html" target="_blank">More complicated examples with docker-compose configuration</a></li>
<li><a href="https://www.elastic.co/guide/en/elasticsearch/reference/8.8/important-settings.html" target="_blank">More service configures for production</a></li>
</ul>

                                
                                </section>
                            
    </div>
    <div class="search-results">
        <div class="has-results">
            
            <h1 class="search-results-title"><span class='search-results-count'></span> results matching "<span class='search-query'></span>"</h1>
            <ul class="search-results-list"></ul>
            
        </div>
        <div class="no-results">
            
            <h1 class="search-results-title">No results matching "<span class='search-query'></span>"</h1>
            
        </div>
    </div>
</div>

                        </div>
                    </div>
                
            </div>

            
                
                <a href="../backend/authorization/authorization_samples.html" class="navigation navigation-prev " aria-label="Previous page: Samples">
                    <i class="fa fa-angle-left"></i>
                </a>
                
                
                <a href="../frontend/configuration.html" class="navigation navigation-next " aria-label="Next page: Frontend">
                    <i class="fa fa-angle-right"></i>
                </a>
                
            
        
    </div>

    <script>
        var gitbook = gitbook || [];
        gitbook.push(function() {
            gitbook.page.hasChanged({"page":{"title":"Elastic Search","level":"1.5.2.6.3","depth":4,"next":{"title":"Frontend","level":"1.5.2.6.4","depth":4,"path":"Development/v4.x/frontend/configuration.md","ref":"Development/v4.x/frontend/configuration.md","articles":[]},"previous":{"title":"Samples","level":"1.5.2.6.2.7","depth":5,"path":"Development/v4.x/backend/authorization/authorization_samples.md","ref":"Development/v4.x/backend/authorization/authorization_samples.md","articles":[]},"dir":"ltr"},"config":{"plugins":["chapter-fold","mermaid-gb3"],"styles":{"website":"styles/website.css"},"pluginsConfig":{"chapter-fold":{},"mermaid-gb3":{},"highlight":{},"search":{},"lunr":{"maxIndexSize":1000000,"ignoreSpecialCharacters":false},"fontsettings":{"theme":"white","family":"sans","size":2},"theme-default":{"styles":{"website":"styles/website.css","pdf":"styles/pdf.css","epub":"styles/epub.css","mobi":"styles/mobi.css","ebook":"styles/ebook.css","print":"styles/print.css"},"showLevel":false}},"theme":"default","pdf":{"pageNumbers":true,"fontSize":12,"fontFamily":"Arial","paperSize":"a4","chapterMark":"pagebreak","pageBreaksBefore":"/","margin":{"right":62,"left":62,"top":56,"bottom":56},"embedFonts":false},"structure":{"langs":"LANGS.md","readme":"README.md","glossary":"GLOSSARY.md","summary":"SUMMARY.md"},"variables":{},"title":"SciCat Documentation","gitbook":"*"},"file":{"path":"Development/v4.x/elasticsearch/elasticsearch.md","mtime":"2025-08-29T12:49:45.943Z","type":"markdown"},"gitbook":{"version":"5.1.4","time":"2025-08-29T12:49:54.198Z"},"basePath":"../../..","book":{"language":""}});
        });
    </script>
</div>

        
    
    <noscript>
        <style>
            .honkit-cloak {
                display: block !important;
            }
        </style>
    </noscript>
    <script>
        // Restore sidebar state as critical path for prevent layout shift
        function __init__getSidebarState(defaultValue){
            var baseKey = "";
            var key = baseKey + ":sidebar";
            try {
                var value = localStorage[key];
                if (value === undefined) {
                    return defaultValue;
                }
                var parsed = JSON.parse(value);
                return parsed == null ? defaultValue : parsed;
            } catch (e) {
                return defaultValue;
            }
        }
        function __init__restoreLastSidebarState() {
            var isMobile = window.matchMedia("(max-width: 600px)").matches;
            if (isMobile) {
                // Init last state if not mobile
                return;
            }
            var sidebarState = __init__getSidebarState(true);
            var book = document.querySelector(".book");
            // Show sidebar if it enabled
            if (sidebarState && book) {
                book.classList.add("without-animation", "with-summary");
            }
        }

        try {
            __init__restoreLastSidebarState();
        } finally {
            var book = document.querySelector(".book");
            book.classList.remove("honkit-cloak");
        }
    </script>
    <script src="../../../gitbook/gitbook.js"></script>
    <script src="../../../gitbook/theme.js"></script>
    
        
        <script src="../../../gitbook/gitbook-plugin-chapter-fold/chapter-fold.js"></script>
        
    
        
        <script src="../../../gitbook/gitbook-plugin-mermaid-gb3/book/plugin.js"></script>
        
    
        
        <script src="../../../gitbook/gitbook-plugin-search/search-engine.js"></script>
        
    
        
        <script src="../../../gitbook/gitbook-plugin-search/search.js"></script>
        
    
        
        <script src="../../../gitbook/gitbook-plugin-lunr/lunr.min.js"></script>
        
    
        
        <script src="../../../gitbook/gitbook-plugin-lunr/search-lunr.js"></script>
        
    
        
        <script src="../../../gitbook/gitbook-plugin-fontsettings/fontsettings.js"></script>
        
    

    <script src="../../../gitbook/gitbook-plugin-mermaid-gb3/mermaid/mermaid.min.js"></script>

    </body>
</html>

