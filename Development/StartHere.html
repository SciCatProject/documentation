
<!DOCTYPE HTML>
<html lang="" >
    <head>
        <meta charset="UTF-8">
        <meta content="text/html; charset=utf-8" http-equiv="Content-Type">
        <title>Overview of Backend and Model Â· SciCat Documentation</title>
        <meta http-equiv="X-UA-Compatible" content="IE=edge" />
        <meta name="description" content="">
        <meta name="generator" content="HonKit 3.6.6">
        
        
        
    
    <link rel="stylesheet" href="../gitbook/style.css">

    
            
                
                <link rel="stylesheet" href="../gitbook/gitbook-plugin-chapter-fold/chapter-fold.css">
                
            
                
                <link rel="stylesheet" href="../gitbook/gitbook-plugin-highlight/website.css">
                
            
                
                <link rel="stylesheet" href="../gitbook/gitbook-plugin-search/search.css">
                
            
                
                <link rel="stylesheet" href="../gitbook/gitbook-plugin-fontsettings/website.css">
                
            
        

    

    
        
    
        
    
        
    
        
    
        
    
        
    

        
    
    
    <meta name="HandheldFriendly" content="true"/>
    <meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black">
    <link rel="apple-touch-icon-precomposed" sizes="152x152" href="../gitbook/images/apple-touch-icon-precomposed-152.png">
    <link rel="shortcut icon" href="../gitbook/images/favicon.ico" type="image/x-icon">

    
    <link rel="next" href="Data_Model.html" />
    
    
    <link rel="prev" href="./" />
    

    </head>
    <body>
        
<div class="book">
    <div class="book-summary">
        
            
<div id="book-search-input" role="search">
    <input type="text" placeholder="Type to search" />
</div>

            
                <nav role="navigation">
                


<ul class="summary">
    
    

    

    
        
        
    
        <li class="chapter " data-level="1.1" data-path="../">
            
                <a href="../">
            
                    
                    SciCat Overview
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.2" data-path="../Users/">
            
                <a href="../Users/">
            
                    
                    User Guide
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.2.1" data-path="../Users/Anonymous.html">
            
                <a href="../Users/Anonymous.html">
            
                    
                    Anonymous View
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.2.2" data-path="../Users/Login.html">
            
                <a href="../Users/Login.html">
            
                    
                    Login
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.2.3" data-path="../Users/Dashboard.html">
            
                <a href="../Users/Dashboard.html">
            
                    
                    Dashboard
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.2.4" data-path="../Users/Dataset_Details.html">
            
                <a href="../Users/Dataset_Details.html">
            
                    
                    Dataset Details
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.2.4.1" data-path="../Users/Dataset_Details_Files.html">
            
                <a href="../Users/Dataset_Details_Files.html">
            
                    
                    Dataset Filelisting
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.2.4.2" data-path="../Users/Dataset_Attachments.html">
            
                <a href="../Users/Dataset_Attachments.html">
            
                    
                    Dataset Attachments
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.2.4.3" data-path="../Users/View_Raw_Metadata.html">
            
                <a href="../Users/View_Raw_Metadata.html">
            
                    
                    View Raw JSON data
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.2.4.4" data-path="../Users/Edit_Scientific_Metadata.html">
            
                <a href="../Users/Edit_Scientific_Metadata.html">
            
                    
                    Edit Scientific Metadata
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.2.5" data-path="../Users/Publishing.html">
            
                <a href="../Users/Publishing.html">
            
                    
                    Dataset Publishing
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.2.6" data-path="../Users/Jobs.html">
            
                <a href="../Users/Jobs.html">
            
                    
                    Archival and Retrieval Jobs
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.2.7" data-path="../Users/SampleData.html">
            
                <a href="../Users/SampleData.html">
            
                    
                    Sample Data Entry
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.3" data-path="../Operator/">
            
                <a href="../Operator/">
            
                    
                    Operator Guide
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.3.1" data-path="../Operator/Step_by_Step_Setup.html">
            
                <a href="../Operator/Step_by_Step_Setup.html">
            
                    
                    Step by Step instruction
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.3.2" data-path="../Operator/Step_by_Step_Setup_Docker.html">
            
                <a href="../Operator/Step_by_Step_Setup_Docker.html">
            
                    
                    Deploy with Docker Compose
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.3.3" data-path="../Operator/Step_by_Step_Setup_Kubernetes.html">
            
                <a href="../Operator/Step_by_Step_Setup_Kubernetes.html">
            
                    
                    Deploy with Kubernetes
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.3.4" data-path="../Operator/Sites/">
            
                <a href="../Operator/Sites/">
            
                    
                    Sites
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.3.4.1" data-path="../Operator/Sites/ESS.html">
            
                <a href="../Operator/Sites/ESS.html">
            
                    
                    ESS Site Specific info
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.3.4.2" data-path="../Operator/Sites/MaxIV.html">
            
                <a href="../Operator/Sites/MaxIV.html">
            
                    
                    MAX IV Site specific info
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.3.4.3" data-path="../Operator/Sites/PSI.html">
            
                <a href="../Operator/Sites/PSI.html">
            
                    
                    PSI Site specific info
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.4" data-path="../Ingestor/">
            
                <a href="../Ingestor/">
            
                    
                    Ingestor Guide
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.4.1" data-path="../Ingestor/ingestManual.html">
            
                <a href="../Ingestor/ingestManual.html">
            
                    
                    Ingest Manual PSI
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.4.2" data-path="../Ingestor/IngestManual_ESS.html">
            
                <a href="../Ingestor/IngestManual_ESS.html">
            
                    
                    Ingest Instructions ESS
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.4.3" data-path="../Ingestor/GettingMetadataIntoScicat.html">
            
                <a href="../Ingestor/GettingMetadataIntoScicat.html">
            
                    
                    Manual Ingest the Hard Way
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.5" data-path="./">
            
                <a href="./">
            
                    
                    Developers Guide
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter active" data-level="1.5.1" data-path="StartHere.html">
            
                <a href="StartHere.html">
            
                    
                    Overview of Backend and Model
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.5.2" data-path="Data_Model.html">
            
                <a href="Data_Model.html">
            
                    
                    An Introduction to the Data Model
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.5.3" data-path="Running.html">
            
                <a href="Running.html">
            
                    
                    Running the Components
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.5.4" data-path="Environment.html">
            
                <a href="Environment.html">
            
                    
                    Configuration files
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.5.5" data-path="Login.html">
            
                <a href="Login.html">
            
                    
                    Login and Accounts
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.5.6" data-path="Ngrx.html">
            
                <a href="Ngrx.html">
            
                    
                    State Management in Angular
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.5.7" data-path="Testing_catamel.html">
            
                <a href="Testing_catamel.html">
            
                    
                    Testing Backend
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.5.8" data-path="Testing.html">
            
                <a href="Testing.html">
            
                    
                    Testing Frontend
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.5.9" data-path="Contributing.html">
            
                <a href="Contributing.html">
            
                    
                    Contributing
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.5.10" data-path="Documentation.html">
            
                <a href="Documentation.html">
            
                    
                    Adding Documentation
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.5.11" data-path="Development_Methods.html">
            
                <a href="Development_Methods.html">
            
                    
                    Git Flow Workflow
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    

    

    <li class="divider"></li>

    <li>
        <a href="https://github.com/honkit/honkit" target="blank" class="gitbook-link">
            Published with HonKit
        </a>
    </li>
</ul>


                </nav>
            
        
    </div>

    <div class="book-body">
        
            <div class="body-inner">
                
                    

<div class="book-header" role="navigation">
    

    <!-- Title -->
    <h1>
        <i class="fa fa-circle-o-notch fa-spin"></i>
        <a href=".." >Overview of Backend and Model</a>
    </h1>
</div>




                    <div class="page-wrapper" tabindex="-1" role="main">
                        <div class="page-inner">
                            
<div id="book-search-results">
    <div class="search-noresults">
    
                                <section class="normal markdown-section">
                                
                                <h2 id="overview-of-backend-and-model">Overview of Backend and Model</h2>
<p>This page provides a brief introduction to the overall workings of the SciCat data model, how things connect and links to more details on each component.</p>
<h3 id="catamel">Catamel</h3>
<p>First off, the backend is the key component here and you will see there is next to hand written code here (aside from some tests). The folder you will be working in most is: <code>common/models</code> and this is NodeJS application based on the Loopback framework. Go away and read the docs for Loopback (3) and come back here when you are fairly comfortable. I&apos;ll wait.</p>
<p>Got it? Good. OK, so, SciCat stores all of its data in a MongoDB but you will almost never need to perform any admin on the database. The connection between loopback and Mongo is handled by the loopback-mongo-connector. The only thing you need to provide is the file in <code>server/datasources.json</code> , this provides the connection string and any connection specific info.</p>
<p>If you take a look at a model, you will see that some of them have a datasource of <code>transient</code> and others are specified as MongoDB. The <code>transient</code> models are not stored or handled by the mongo connector. You will see some other sections, so let&apos;s go through them:</p>
<h4 id="model-definitions">Model Definitions:</h4>
<ul>
<li>Properties: These are the values, types and other information. None of these are mongo specific and can all map to a relational database just as easily.</li>
<li>Relations: These link models, i.e. allowing a DatasetLifecycle to be linked to a Dataset. The mongo connector handles this by embedding the datasetId in the document for you.</li>
<li>ACLs: These are access control limitations and these are very powerful. You can give a user full control of a model, some users can only have read access etc.</li>
<li>Methods: When you create a model, loopback will automagically generate API endpoints that allows users to PUT, POST, PATCH, GET etc for all the models. However, sometimes this is not enough. For example, you may want to be able to generate a monthly report of all datasets created, so you define the method here, the name of the endpoint and the expected parameters. You will implement the method in the next section we cover now.</li>
</ul>
<h4 id="model-implementation">Model Implementation:</h4>
<p>As just mentioned, Loopback handles all the basic RESTful commands for a model for you but there are two ways to extend this:</p>
<ul>
<li>Custom methods: You can extend your model with methods that allow you to implement logic beyond what loopback provides</li>
<li>Remote hooks: Before a particular endpoint (or all endpoints) are called, or before a document is saved/edited/accessed, then you can use these hooks to implement some logic. For example, you may want to inject some extra information into a JSON object before it is saved or ensure the user has some access control that is outside of your Loopback system.</li>
</ul>
<p>For the best example of these, take a look at the Dataset JS and JSON files, this also shows how relations work between models.</p>
<h4 id="running-catamel">Running Catamel</h4>
<p>Catamel has some core files missing that are required in order for it to run. Below, we list these files and what they should contain. Ideally, there will be a minimal install of Catamel in the source repo that includes minimal config files to remove this barrier.</p>
<ul>
<li><code>datasources.json</code> - This sets up your connection to Mongo and should follow the syntax outlined in <a href="https://loopback.io/doc/en/lb3/datasources.json.html" target="_blank">loopback</a> </li>
<li><code>config.local.js</code> - These are site specific settings for your install, such as the prefix to use for IDs, messages to store in the dataset and the facilities you have</li>
<li><code>providers.json</code> - Contains connection information to LDAP or other authentication sources</li>
<li><code>component-config.json</code> - This file connects to RabbitMQ or (in the case of testing) connects to a local rabbitmq, but this file should not be required in the future so the queuing system used is not fixed</li>
</ul>
<h4 id="testing-catamel">Testing Catamel</h4>
<p>All tests for catamel are in the <code>test</code> folder in the root of the repo and can be run with <code>npm run test</code>. </p>
<h2 id="python-client-api">Python Client API</h2>
<p>The API is automatically created from the Swagger/openAPI (<a href="http://swagger.io/" target="_blank">http://swagger.io/</a>) specificication created from the data model using the <a href="https://github.com/swagger-api/swagger-codegen" target="_blank">Swagger Codegen code</a></p>
<pre><code>java -jar ./swagger-codegen/modules/swagger-codegen-cli/target/swagger-codegen-cli.jar generate -i swagger.json -l python -o dacat-api/client/python
</code></pre>
                                
                                </section>
                            
    </div>
    <div class="search-results">
        <div class="has-results">
            
            <h1 class="search-results-title"><span class='search-results-count'></span> results matching "<span class='search-query'></span>"</h1>
            <ul class="search-results-list"></ul>
            
        </div>
        <div class="no-results">
            
            <h1 class="search-results-title">No results matching "<span class='search-query'></span>"</h1>
            
        </div>
    </div>
</div>

                        </div>
                    </div>
                
            </div>

            
                
                <a href="./" class="navigation navigation-prev " aria-label="Previous page: Developers Guide">
                    <i class="fa fa-angle-left"></i>
                </a>
                
                
                <a href="Data_Model.html" class="navigation navigation-next " aria-label="Next page: An Introduction to the Data Model">
                    <i class="fa fa-angle-right"></i>
                </a>
                
            
        
    </div>

    <script>
        var gitbook = gitbook || [];
        gitbook.push(function() {
            gitbook.page.hasChanged({"page":{"title":"Overview of Backend and Model","level":"1.5.1","depth":2,"next":{"title":"An Introduction to the Data Model","level":"1.5.2","depth":2,"path":"Development/Data_Model.md","ref":"Development/Data_Model.md","articles":[]},"previous":{"title":"Developers Guide","level":"1.5","depth":1,"path":"Development/README.md","ref":"Development/README.md","articles":[{"title":"Overview of Backend and Model","level":"1.5.1","depth":2,"path":"Development/StartHere.md","ref":"Development/StartHere.md","articles":[]},{"title":"An Introduction to the Data Model","level":"1.5.2","depth":2,"path":"Development/Data_Model.md","ref":"Development/Data_Model.md","articles":[]},{"title":"Running the Components","level":"1.5.3","depth":2,"path":"Development/Running.md","ref":"Development/Running.md","articles":[]},{"title":"Configuration files","level":"1.5.4","depth":2,"path":"Development/Environment.md","ref":"Development/Environment.md","articles":[]},{"title":"Login and Accounts","level":"1.5.5","depth":2,"path":"Development/Login.md","ref":"Development/Login.md","articles":[]},{"title":"State Management in Angular","level":"1.5.6","depth":2,"path":"Development/Ngrx.md","ref":"Development/Ngrx.md","articles":[]},{"title":"Testing Backend","level":"1.5.7","depth":2,"path":"Development/Testing_catamel.md","ref":"Development/Testing_catamel.md","articles":[]},{"title":"Testing Frontend","level":"1.5.8","depth":2,"path":"Development/Testing.md","ref":"Development/Testing.md","articles":[]},{"title":"Contributing","level":"1.5.9","depth":2,"path":"Development/Contributing.md","ref":"Development/Contributing.md","articles":[]},{"title":"Adding Documentation","level":"1.5.10","depth":2,"path":"Development/Documentation.md","ref":"Development/Documentation.md","articles":[]},{"title":"Git Flow Workflow","level":"1.5.11","depth":2,"path":"Development/Development_Methods.md","ref":"Development/Development_Methods.md","articles":[]}]},"dir":"ltr"},"config":{"plugins":["chapter-fold"],"styles":{"website":"styles/website.css","pdf":"styles/pdf.css","epub":"styles/epub.css","mobi":"styles/mobi.css","ebook":"styles/ebook.css","print":"styles/print.css"},"pluginsConfig":{"chapter-fold":{},"highlight":{},"search":{},"lunr":{"maxIndexSize":1000000,"ignoreSpecialCharacters":false},"fontsettings":{"theme":"white","family":"sans","size":2},"theme-default":{"styles":{"website":"styles/website.css","pdf":"styles/pdf.css","epub":"styles/epub.css","mobi":"styles/mobi.css","ebook":"styles/ebook.css","print":"styles/print.css"},"showLevel":false}},"theme":"default","pdf":{"pageNumbers":true,"fontSize":12,"fontFamily":"Arial","paperSize":"a4","chapterMark":"pagebreak","pageBreaksBefore":"/","margin":{"right":62,"left":62,"top":56,"bottom":56},"embedFonts":false},"structure":{"langs":"LANGS.md","readme":"README.md","glossary":"GLOSSARY.md","summary":"SUMMARY.md"},"variables":{},"title":"SciCat Documentation","gitbook":"*"},"file":{"path":"Development/StartHere.md","mtime":"2020-10-14T08:23:09.873Z","type":"markdown"},"gitbook":{"version":"3.6.6","time":"2020-10-14T08:23:20.718Z"},"basePath":"..","book":{"language":""}});
        });
    </script>
</div>

        
    <script src="../gitbook/gitbook.js"></script>
    <script src="../gitbook/theme.js"></script>
    
        
        <script src="../gitbook/gitbook-plugin-chapter-fold/chapter-fold.js"></script>
        
    
        
        <script src="../gitbook/gitbook-plugin-search/search-engine.js"></script>
        
    
        
        <script src="../gitbook/gitbook-plugin-search/search.js"></script>
        
    
        
        <script src="../gitbook/gitbook-plugin-lunr/lunr.min.js"></script>
        
    
        
        <script src="../gitbook/gitbook-plugin-lunr/search-lunr.js"></script>
        
    
        
        <script src="../gitbook/gitbook-plugin-fontsettings/fontsettings.js"></script>
        
    

    </body>
</html>

