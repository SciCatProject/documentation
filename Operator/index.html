
<!DOCTYPE HTML>
<html lang="" >
    <head>
        <meta charset="UTF-8">
        <title>Operator Guide Â· SciCat Documentation</title>
        <meta http-equiv="X-UA-Compatible" content="IE=edge" />
        <meta name="description" content="">
        <meta name="generator" content="HonKit 3.7.1">
        
        
        
    
    <link rel="stylesheet" href="../gitbook/style.css">

    
            
                
                <link rel="stylesheet" href="../gitbook/gitbook-plugin-chapter-fold/chapter-fold.css">
                
            
                
                <link rel="stylesheet" href="../gitbook/gitbook-plugin-highlight/website.css">
                
            
                
                <link rel="stylesheet" href="../gitbook/gitbook-plugin-search/search.css">
                
            
                
                <link rel="stylesheet" href="../gitbook/gitbook-plugin-fontsettings/website.css">
                
            
        

    

    
        
    
        
    
        
    
        
    
        
    
        
    

        
    
    
    <meta name="HandheldFriendly" content="true"/>
    <meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black">
    <link rel="apple-touch-icon-precomposed" sizes="152x152" href="../gitbook/images/apple-touch-icon-precomposed-152.png">
    <link rel="shortcut icon" href="../gitbook/images/favicon.ico" type="image/x-icon">

    
    <link rel="next" href="Step_by_Step_Setup.html" />
    
    
    <link rel="prev" href="../Users/SampleData.html" />
    

    </head>
    <body>
        
<div class="book honkit-cloak">
    <div class="book-summary">
        
            
<div id="book-search-input" role="search">
    <input type="text" placeholder="Type to search" />
</div>

            
                <nav role="navigation">
                


<ul class="summary">
    
    

    

    
        
        
    
        <li class="chapter " data-level="1.1" data-path="../">
            
                <a href="../">
            
                    
                    SciCat Overview
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.2" data-path="../Users/">
            
                <a href="../Users/">
            
                    
                    User Guide
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.2.1" data-path="../Users/Anonymous.html">
            
                <a href="../Users/Anonymous.html">
            
                    
                    Anonymous View
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.2.2" data-path="../Users/Login.html">
            
                <a href="../Users/Login.html">
            
                    
                    Login
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.2.3" data-path="../Users/Dashboard.html">
            
                <a href="../Users/Dashboard.html">
            
                    
                    Dashboard
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.2.4" data-path="../Users/Dataset_Details.html">
            
                <a href="../Users/Dataset_Details.html">
            
                    
                    Dataset Details
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.2.4.1" data-path="../Users/Dataset_Details_Files.html">
            
                <a href="../Users/Dataset_Details_Files.html">
            
                    
                    Dataset Filelisting
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.2.4.2" data-path="../Users/Dataset_Attachments.html">
            
                <a href="../Users/Dataset_Attachments.html">
            
                    
                    Dataset Attachments
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.2.4.3" data-path="../Users/View_Raw_Metadata.html">
            
                <a href="../Users/View_Raw_Metadata.html">
            
                    
                    View Raw JSON data
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.2.4.4" data-path="../Users/Edit_Scientific_Metadata.html">
            
                <a href="../Users/Edit_Scientific_Metadata.html">
            
                    
                    Edit Scientific Metadata
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.2.5" data-path="../Users/Publishing.html">
            
                <a href="../Users/Publishing.html">
            
                    
                    Dataset Publishing
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.2.6" data-path="../Users/Jobs.html">
            
                <a href="../Users/Jobs.html">
            
                    
                    Archival and Retrieval Jobs
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.2.7" data-path="../Users/SampleData.html">
            
                <a href="../Users/SampleData.html">
            
                    
                    Sample Data Entry
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter active" data-level="1.3" data-path="./">
            
                <a href="./">
            
                    
                    Operator Guide
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.3.1" data-path="Step_by_Step_Setup.html">
            
                <a href="Step_by_Step_Setup.html">
            
                    
                    Step by Step instruction
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.3.2" data-path="Step_by_Step_Setup_Docker.html">
            
                <a href="Step_by_Step_Setup_Docker.html">
            
                    
                    Deploy with Docker Compose
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.3.3" data-path="Step_by_Step_Setup_Kubernetes.html">
            
                <a href="Step_by_Step_Setup_Kubernetes.html">
            
                    
                    Deploy with Kubernetes
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.3.4" data-path="Sites/">
            
                <a href="Sites/">
            
                    
                    Sites
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.3.4.1" data-path="Sites/ESS.html">
            
                <a href="Sites/ESS.html">
            
                    
                    ESS Site Specific info
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.3.4.2" data-path="Sites/MaxIV.html">
            
                <a href="Sites/MaxIV.html">
            
                    
                    MAX IV Site specific info
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.3.4.3" data-path="Sites/PSI.html">
            
                <a href="Sites/PSI.html">
            
                    
                    PSI Site specific info
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.4" data-path="../Ingestor/">
            
                <a href="../Ingestor/">
            
                    
                    Ingestor Guide
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.4.1" data-path="../Ingestor/ingestManual.html">
            
                <a href="../Ingestor/ingestManual.html">
            
                    
                    Ingest Manual PSI
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.4.2" data-path="../Ingestor/IngestManual_ESS.html">
            
                <a href="../Ingestor/IngestManual_ESS.html">
            
                    
                    Ingest Instructions ESS
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.4.3" data-path="../Ingestor/GettingMetadataIntoScicat.html">
            
                <a href="../Ingestor/GettingMetadataIntoScicat.html">
            
                    
                    Manual Ingest the Hard Way
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.5" data-path="../Development/">
            
                <a href="../Development/">
            
                    
                    Developers Guide
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.5.1" data-path="../Development/StartHere.html">
            
                <a href="../Development/StartHere.html">
            
                    
                    Overview of Backend and Model
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.5.2" data-path="../Development/Data_Model.html">
            
                <a href="../Development/Data_Model.html">
            
                    
                    An Introduction to the Data Model
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.5.3" data-path="../Development/Running.html">
            
                <a href="../Development/Running.html">
            
                    
                    Running the Components
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.5.4" data-path="../Development/Configuration.html">
            
                <a href="../Development/Configuration.html">
            
                    
                    Configuration
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.5.5" data-path="../Development/Theming.html">
            
                <a href="../Development/Theming.html">
            
                    
                    Theming
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.5.6" data-path="../Development/Login.html">
            
                <a href="../Development/Login.html">
            
                    
                    Login and Accounts
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.5.7" data-path="../Development/OIDC.html">
            
                <a href="../Development/OIDC.html">
            
                    
                    OIDC Integration
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.5.8" data-path="../Development/Ngrx.html">
            
                <a href="../Development/Ngrx.html">
            
                    
                    State Management in Angular
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.5.9" data-path="../Development/Testing_catamel.html">
            
                <a href="../Development/Testing_catamel.html">
            
                    
                    Testing Backend
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.5.10" data-path="../Development/Testing.html">
            
                <a href="../Development/Testing.html">
            
                    
                    Testing Frontend
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.5.11" data-path="../Development/Contributing.html">
            
                <a href="../Development/Contributing.html">
            
                    
                    Contributing
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.5.12" data-path="../Development/Documentation.html">
            
                <a href="../Development/Documentation.html">
            
                    
                    Adding Documentation
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.5.13" data-path="../Development/Development_Methods.html">
            
                <a href="../Development/Development_Methods.html">
            
                    
                    Git Flow Workflow
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.6" >
            
                <a target="_blank" href="https://scicatproject.github.io/api/">
            
                    
                    API Documentation
            
                </a>
            

            
        </li>
    

    

    <li class="divider"></li>

    <li>
        <a href="https://github.com/honkit/honkit" target="blank" class="gitbook-link">
            Published with HonKit
        </a>
    </li>
</ul>


                </nav>
            
        
    </div>

    <div class="book-body">
        
            <div class="body-inner">
                
                    

<div class="book-header" role="navigation">
    

    <!-- Title -->
    <h1>
        <i class="fa fa-circle-o-notch fa-spin"></i>
        <a href=".." >Operator Guide</a>
    </h1>
</div>




                    <div class="page-wrapper" tabindex="-1" role="main">
                        <div class="page-inner">
                            
<div id="book-search-results">
    <div class="search-noresults">
    
                                <section class="normal markdown-section">
                                
                                <h1 id="overview">Overview</h1>
<p>Getting SciCat up and running at your site should be rather straight forward for a test deployment. However turning into a production ready system may involve a bit more work, because different existing systems will need to be interfaced to SciCat</p>
<h2 id="understanding-the-components">Understanding the Components</h2>
<p>For the subsequent sections it will be useful to have a &quot;helicopter&quot; overview of the various components that need to play together seamlessly. The following diagram shows these components and also shows potentially existing components at your site, that you would likely want to interface to SciCat. The specific diagram reflects essentially the situation at PSI as of Sept. 2020. Of course your situation may look different. The diagram should therefore be seen as an <em>example</em> , which you need to adapt to your situation.</p>
<p><img src="img/DacatDataflowV3.png" alt="Architecture Overview and Environment Integration"></p>
<h3 id="backend">Backend</h3>
<p>At the heart of the SciCat architecture there is the REST API server <a href="https://github.com/SciCatProject/catamel" target="_blank">Catamel</a>. This is a  NodeJS application that uses the Loopback 3 framework to generate RESTful APIs from JSON files that define models (such as: Users, Datasets, Instruments etc). Following the Swagger/OpenAPI format SDKs can be generated in almost any language.</p>
<p>The persistence layer behind this API server is a <a href="https://www.mongodb.com/" target="_blank">MongoDB</a> instance, i.e an open source, NoSQL, document-based database solution. The API server handles alll the bi-directional communication from the REST interface to the Database.</p>
<p>These two components together comprise the &quot;backend&quot; of the architecture.</p>
<h3 id="frontend">Frontend</h3>
<p>To the REST server an arbitrary number of &quot;clients&quot; (frontends) can be connected. One of the most important clients is the web based GUI frontend <a href="https://github.com/SciCatProject/catanie" target="_blank">Catanie</a>. This allows to communicate with the data catalog in a user friendly way. It is based on the Angular (9+) technology and uses ngrx to communicate with the SciCat API and provide a searchable interface for datasets, as well as the option to carry out actions (i.e. archiving).</p>
<p>In addition to the GUI other clients exist, such as command line (CLI) clients (example exist written in GO and Python) or desktop based GUI applications based on Qt. The CLI tools are especially useful for automated workflows, e.g. to get the data into the data catalog. This process is termed &quot;ingestion&quot; of the data. But they can also be used to add the data manually, especially for derived data, since this part of the workflow is often not possible to automate, in particular in truly <em>experimental</em> setups.</p>
<h3 id="messaging-infrastructure">Messaging infrastructure</h3>
<p>As a way to loosely couple external systems the API server can be connected to messaging system. In particular RabbitMQ (used at PSI) and Apache Kafka are in use. Such systems can e.g. be used to interface to an tape archive system. To add the specific business logic you can e.g. add your own scripting layer. At PSI however a <a href="https://nodered.org/" target="_blank">Node-RED</a>  based solution proofed to be a stable and flexible platform for this purpose. Node-RED is a A NodeJS based visual programming tool to handle flows of data from one source to another. The following shows the Nod-RED flow used for communicating job requests to the PSI archive system</p>
<p><img src="img/job-assembler.png" alt="Job-Assembler at PSI"></p>
<h3 id="publishing-server">Publishing Server</h3>
<p>In order to publish data you need to run a landing page server and you need to assign DOIs to your published data. Since the API server may be operated in an intranet, with no access to the internet the following architecture was chosen at PSI:</p>
<p>An OAI-PMH server is running in a DMZ connected to a local Mongo instance. At publication time the data from SciCat is <strong>pushed</strong> to the external OAI-PMH server.
From this server the landing page server can fetch the information about the published data. Also external DOI systems connect to this OAI-PMH server to synchronize the data with the world wide DOI system. </p>
<p>If a user wants to download the full datasets of the published data, the data is copied from the internal file server to a https file server (acting as a cache file server) , which subsequently allows anaonymous download of the data</p>
<h3 id="chat-server-as-electronic-logbook">Chat Server as electronic logbook</h3>
<p>TODO ESS</p>
<h3 id="external-systems">External systems</h3>
<p>The most important external system, that you want to connect to is likely your local identity management (IDM) system, e.g. an LDAP or AD based solution. This is usually the source of both the authentication and the authorization information, the latter being realized by simple group membership of the users.</p>
<p>Another important external system, that you may want to connect, is your local proposal handling system (such as DUO at PSI). This defines, which user is allowed to measure at what instrument or beamline at what time. If you do not have such a system you can fill the Proposal Information also by hand, or just leave it empty. If you have such a system you need to write scripts which synchronize the data in these systems with the corresponding tables in the SciCat Database, i.e. the <em>Proposal</em> collection</p>
<p>Finally external storage systems, in particular those dealing with storage on tape, are a good candidate of an external system</p>
<p>File servers are another component that you may want to integrate. The SciCat architecture does not require any such connection to the file contents, since it deals with metadata only. However the GUI can link to storage systems, which offer to download data using the https protocol.</p>
<h3 id="underlying-infrastructure">Underlying Infrastructure</h3>
<p>You may or may not run the infrastructure as part of a Kubernetes cluster. E.g. at PSI the API server, the GUI application, RabbitMQ and the Node-RED instances are all deployed to a Kubernetes cluster, whereas the Mongo DB ist kept outside Kubernetes.
Kubernetes is not necessary to have, but can simplify your life quite a bit. Also the separation into internet and intranet zones is up to you to define. You can of course operate the whole infrastructure directly in internet accessible servers, if your security policies permit.</p>

                                
                                </section>
                            
    </div>
    <div class="search-results">
        <div class="has-results">
            
            <h1 class="search-results-title"><span class='search-results-count'></span> results matching "<span class='search-query'></span>"</h1>
            <ul class="search-results-list"></ul>
            
        </div>
        <div class="no-results">
            
            <h1 class="search-results-title">No results matching "<span class='search-query'></span>"</h1>
            
        </div>
    </div>
</div>

                        </div>
                    </div>
                
            </div>

            
                
                <a href="../Users/SampleData.html" class="navigation navigation-prev " aria-label="Previous page: Sample Data Entry">
                    <i class="fa fa-angle-left"></i>
                </a>
                
                
                <a href="Step_by_Step_Setup.html" class="navigation navigation-next " aria-label="Next page: Step by Step instruction">
                    <i class="fa fa-angle-right"></i>
                </a>
                
            
        
    </div>

    <script>
        var gitbook = gitbook || [];
        gitbook.push(function() {
            gitbook.page.hasChanged({"page":{"title":"Operator Guide","level":"1.3","depth":1,"next":{"title":"Step by Step instruction","level":"1.3.1","depth":2,"path":"Operator/Step_by_Step_Setup.md","ref":"Operator/Step_by_Step_Setup.md","articles":[]},"previous":{"title":"Sample Data Entry","level":"1.2.7","depth":2,"path":"Users/SampleData.md","ref":"Users/SampleData.md","articles":[]},"articles":[{"title":"Step by Step instruction","level":"1.3.1","depth":2,"path":"Operator/Step_by_Step_Setup.md","ref":"Operator/Step_by_Step_Setup.md","articles":[]},{"title":"Deploy with Docker Compose","level":"1.3.2","depth":2,"path":"Operator/Step_by_Step_Setup_Docker.md","ref":"Operator/Step_by_Step_Setup_Docker.md","articles":[]},{"title":"Deploy with Kubernetes","level":"1.3.3","depth":2,"path":"Operator/Step_by_Step_Setup_Kubernetes.md","ref":"Operator/Step_by_Step_Setup_Kubernetes.md","articles":[]},{"title":"Sites","level":"1.3.4","depth":2,"path":"Operator/Sites/README.md","ref":"Operator/Sites/README.md","articles":[{"title":"ESS Site Specific info","level":"1.3.4.1","depth":3,"path":"Operator/Sites/ESS.md","ref":"Operator/Sites/ESS.md","articles":[]},{"title":"MAX IV Site specific info","level":"1.3.4.2","depth":3,"path":"Operator/Sites/MaxIV.md","ref":"Operator/Sites/MaxIV.md","articles":[]},{"title":"PSI Site specific info","level":"1.3.4.3","depth":3,"path":"Operator/Sites/PSI.md","ref":"Operator/Sites/PSI.md","articles":[]}]}],"dir":"ltr"},"config":{"plugins":["chapter-fold"],"styles":{"website":"styles/website.css","pdf":"styles/pdf.css","epub":"styles/epub.css","mobi":"styles/mobi.css","ebook":"styles/ebook.css","print":"styles/print.css"},"pluginsConfig":{"chapter-fold":{},"highlight":{},"search":{},"lunr":{"maxIndexSize":1000000,"ignoreSpecialCharacters":false},"fontsettings":{"theme":"white","family":"sans","size":2},"theme-default":{"styles":{"website":"styles/website.css","pdf":"styles/pdf.css","epub":"styles/epub.css","mobi":"styles/mobi.css","ebook":"styles/ebook.css","print":"styles/print.css"},"showLevel":false}},"theme":"default","pdf":{"pageNumbers":true,"fontSize":12,"fontFamily":"Arial","paperSize":"a4","chapterMark":"pagebreak","pageBreaksBefore":"/","margin":{"right":62,"left":62,"top":56,"bottom":56},"embedFonts":false},"structure":{"langs":"LANGS.md","readme":"README.md","glossary":"GLOSSARY.md","summary":"SUMMARY.md"},"variables":{},"title":"SciCat Documentation","gitbook":"*"},"file":{"path":"Operator/README.md","mtime":"2022-05-12T06:57:17.959Z","type":"markdown"},"gitbook":{"version":"3.7.1","time":"2022-05-12T06:57:30.213Z"},"basePath":"..","book":{"language":""}});
        });
    </script>
</div>

        
    <noscript>
        <style>
            .honkit-cloak {
                display: block !important;
            }
        </style>
    </noscript>
    <script>
        // Restore sidebar state as critical path for prevent layout shift
        function __init__getSidebarState(defaultValue){
            var baseKey = "";
            var key = baseKey + ":sidebar";
            try {
                var value = localStorage[key];
                if (value === undefined) {
                    return defaultValue;
                }
                var parsed = JSON.parse(value);
                return parsed == null ? defaultValue : parsed;
            } catch (e) {
                return defaultValue;
            }
        }
        function __init__restoreLastSidebarState() {
            var isMobile = window.matchMedia("(max-width: 600px)").matches;
            if (isMobile) {
                // Init last state if not mobile
                return;
            }
            var sidebarState = __init__getSidebarState(true);
            var book = document.querySelector(".book");
            // Show sidebar if it enabled
            if (sidebarState && book) {
                book.classList.add("without-animation", "with-summary");
            }
        }

        try {
            __init__restoreLastSidebarState();
        } finally {
            var book = document.querySelector(".book");
            book.classList.remove("honkit-cloak");
        }
    </script>
    <script src="../gitbook/gitbook.js"></script>
    <script src="../gitbook/theme.js"></script>
    
        
        <script src="../gitbook/gitbook-plugin-chapter-fold/chapter-fold.js"></script>
        
    
        
        <script src="../gitbook/gitbook-plugin-search/search-engine.js"></script>
        
    
        
        <script src="../gitbook/gitbook-plugin-search/search.js"></script>
        
    
        
        <script src="../gitbook/gitbook-plugin-lunr/lunr.min.js"></script>
        
    
        
        <script src="../gitbook/gitbook-plugin-lunr/search-lunr.js"></script>
        
    
        
        <script src="../gitbook/gitbook-plugin-fontsettings/fontsettings.js"></script>
        
    

    </body>
</html>

